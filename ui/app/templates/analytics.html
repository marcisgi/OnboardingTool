{% extends "base.html" %}
{% block content %}
<section class="mx-auto w-full max-w-5xl px-6 py-8">
  <div class="rounded-3xl border border-slate-200 bg-white p-6 shadow-soft-xl dark:border-slate-700 dark:bg-base-800">
    <div class="flex items-center justify-between gap-4">
      <div>
        <h2 class="text-xl font-semibold text-slate-900 dark:text-white">Usage Analytics</h2>
        <p class="text-sm text-slate-500">Track tool engagement and access behavior.</p>
      </div>
      <a id="refreshButton" href="/analytics" class="flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-2 text-xs font-semibold text-slate-600 transition hover:border-slate-300 dark:border-slate-700 dark:text-slate-200">
        <span id="refreshLabel">Refresh</span>
        <span id="refreshSpinner" class="hidden h-3 w-3 animate-spin rounded-full border-2 border-slate-400 border-t-transparent"></span>
      </a>
    </div>
    <div class="mt-6 grid gap-4 md:grid-cols-3">
      <div class="rounded-2xl border border-slate-200 p-4 dark:border-slate-700">
        <p class="text-xs uppercase text-slate-500">Total Interactions</p>
        <p class="text-2xl font-semibold">{{ data.total_interactions or 0 }}</p>
        <p class="text-xs text-slate-400">All tracked events</p>
      </div>
      <div class="rounded-2xl border border-slate-200 p-4 dark:border-slate-700">
        <p class="text-xs uppercase text-slate-500">Tool Views</p>
        <p class="text-2xl font-semibold">{{ data.total_views or 0 }}</p>
        <p class="text-xs text-slate-400">Modal / detail opens</p>
      </div>
      <div class="rounded-2xl border border-slate-200 p-4 dark:border-slate-700">
        <p class="text-xs uppercase text-slate-500">Tool Opens</p>
        <p class="text-2xl font-semibold">{{ data.total_opens or 0 }}</p>
        <p class="text-xs text-slate-400">Direct launches</p>
      </div>
    </div>
    <div class="mt-6 grid gap-6 md:grid-cols-2">
      <div class="rounded-2xl border border-slate-200 p-4 dark:border-slate-700">
        <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-500">Top Tools</h3>
        <ul class="mt-4 space-y-3 text-sm">
          {% for item in data.top_tools or [] %}
          <li class="flex items-center justify-between rounded-xl bg-slate-50 px-3 py-2 dark:bg-base-900">
            <span class="font-medium text-slate-900 dark:text-white">{{ item.tool_title }}</span>
            <span class="rounded-full bg-white px-2 py-1 text-xs text-slate-500 shadow dark:bg-base-800">{{ item.count }}</span>
          </li>
          {% else %}
          <li class="text-slate-500">No data yet.</li>
          {% endfor %}
        </ul>
      </div>
      <div class="rounded-2xl border border-slate-200 p-4 dark:border-slate-700">
        <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-500">Recent Activity</h3>
        <ul class="mt-4 space-y-3 text-xs">
          {% for entry in data.recent_activity or [] %}
          <li class="rounded-xl bg-slate-50 px-3 py-2 dark:bg-base-900">
            <p class="font-semibold text-slate-900 dark:text-white">{{ entry.tool_title }}</p>
            <p class="text-slate-500">{{ entry.action }} â€¢ {{ entry.timestamp }}</p>
          </li>
          {% else %}
          <li class="text-slate-500">No activity yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</section>
<script>
  const refreshButton = document.getElementById("refreshButton");
  refreshButton.addEventListener("click", () => {
    document.getElementById("refreshLabel").textContent = "Loading";
    document.getElementById("refreshSpinner").classList.remove("hidden");
  });
</script>
{% endblock %}
