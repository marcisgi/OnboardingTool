{% extends "base.html" %}
{% block content %}
<section class="mx-auto w-full max-w-5xl">
  <div class="rounded-3xl border border-slate-200 bg-white/80 p-6 shadow-lg shadow-slate-200/40 dark:border-slate-800 dark:bg-slate-900/70 dark:shadow-none">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold">Usage Analytics</h2>
      <a id="refreshButton" href="/analytics" class="flex items-center gap-2 rounded-xl border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 dark:border-slate-700 dark:text-slate-200">
        <span id="refreshLabel">Refresh</span>
        <span id="refreshSpinner" class="hidden h-3 w-3 animate-spin rounded-full border-2 border-slate-400 border-t-transparent"></span>
      </a>
    </div>
    <div class="mt-6 grid gap-4 md:grid-cols-3">
      <div class="rounded-2xl border border-slate-200 bg-white/80 p-4 dark:border-slate-800 dark:bg-slate-900/70">
        <p class="text-xs uppercase text-slate-500">Total Interactions</p>
        <p class="text-2xl font-semibold">{{ data.total_interactions or 0 }}</p>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-white/80 p-4 dark:border-slate-800 dark:bg-slate-900/70">
        <p class="text-xs uppercase text-slate-500">Tool Views</p>
        <p class="text-2xl font-semibold">{{ data.total_views or 0 }}</p>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-white/80 p-4 dark:border-slate-800 dark:bg-slate-900/70">
        <p class="text-xs uppercase text-slate-500">Tool Opens</p>
        <p class="text-2xl font-semibold">{{ data.total_opens or 0 }}</p>
      </div>
    </div>
    <div class="mt-6 grid gap-6 md:grid-cols-2">
      <div>
        <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-500">Top Tools</h3>
        <ul class="mt-3 space-y-2 text-sm">
          {% for item in data.top_tools or [] %}
          <li class="flex items-center justify-between rounded-xl border border-slate-200 bg-white/80 px-3 py-2 dark:border-slate-800 dark:bg-slate-900/70">
            <span>{{ item.tool_title }}</span>
            <span class="text-xs text-slate-500">{{ item.count }}</span>
          </li>
          {% else %}
          <li class="text-slate-500">No data yet.</li>
          {% endfor %}
        </ul>
      </div>
      <div>
        <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-500">Recent Activity</h3>
        <ul class="mt-3 space-y-2 text-xs">
          {% for entry in data.recent_activity or [] %}
          <li class="rounded-xl border border-slate-200 bg-white/80 px-3 py-2 dark:border-slate-800 dark:bg-slate-900/70">
            <p class="font-semibold">{{ entry.tool_title }}</p>
            <p class="text-slate-500">{{ entry.action }} â€¢ {{ entry.timestamp }}</p>
          </li>
          {% else %}
          <li class="text-slate-500">No activity yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</section>
<script>
  const refreshButton = document.getElementById("refreshButton");
  refreshButton.addEventListener("click", () => {
    document.getElementById("refreshLabel").textContent = "Loading";
    document.getElementById("refreshSpinner").classList.remove("hidden");
  });
</script>
{% endblock %}
